<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Zignal Agency | Creative Dashboard</title>
    
    <!-- React & ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@0.292.0/dist/umd/lucide.min.js"></script>

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    },
                    colors: {
                        zignal: {
                            blue: '#0066FF',
                            cyan: '#00E5FF',
                            dark: '#0B1120',
                            light: '#F0F9FF',
                            gray: '#1E293B',
                            danger: '#EF4444'
                        }
                    }
                }
            }
        }
    </script>

    <style>
        body { background-color: #F8FAFC; -webkit-tap-highlight-color: transparent; }
        .glass-panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
        }
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .calendar-day:active { transform: scale(0.98); }
        
        /* Mobile optimizaciones */
        input, select, textarea { font-size: 16px !important; } /* Previene zoom en iOS */
    </style>
</head>
<body class="text-slate-800 antialiased pb-10">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;

        // --- Mock Data ---
        const initialData = [
            { id: 1, dateRequest: '2026-02-10', requester: 'Dept. Publicidad', campaignName: 'Lanzamiento Q1', format: 'Reel', location: 'Instagram', description: 'Video din√°mico mostrando los nuevos productos.', referenceLink: 'https://drive.google.com/ejemplo', deadline: '2026-02-15', includedInPlan: true, price: 0, status: 'In Progress', priority: 'High' },
            { id: 2, dateRequest: '2026-02-11', requester: 'Zignal', campaignName: 'Promo San Valent√≠n', format: 'Email', location: 'Email', description: 'Newsletter con descuentos.', referenceLink: '', deadline: '2026-02-13', includedInPlan: true, price: 0, status: 'Pending', priority: 'Medium' },
            { id: 3, dateRequest: '2026-02-05', requester: 'Extra', campaignName: 'Evento Corporativo', format: 'Impreso', location: 'Brochure', description: 'Dise√±o de tr√≠ptico.', referenceLink: '', deadline: '2026-02-20', includedInPlan: false, price: 500, status: 'Waiting Approval', priority: 'Low' },
            { id: 4, dateRequest: '2026-01-20', requester: 'Junta Directiva', campaignName: 'Reporte Anual', format: 'Post', location: 'LinkedIn', description: 'Resumen de logros.', referenceLink: '', deadline: '2026-01-30', includedInPlan: true, price: 0, status: 'Finalized', priority: 'High' },
        ];

        const initialEvents = {
            '2026-02-14': [{ text: 'San Valent√≠n', type: 'holiday' }],
            '2026-02-28': [{ text: 'Cierre de Mes', type: 'admin' }],
            '2026-03-08': [{ text: 'D√≠a de la Mujer', type: 'holiday' }],
            '2026-04-01': [{ text: 'Inicio Q2', type: 'campaign' }]
        };

        // --- Simulaci√≥n IA ---
        const callGemini = async (prompt) => {
            return new Promise((resolve) => {
                setTimeout(() => {
                    const responses = [
                        "Sugiero usar colores vibrantes y tipograf√≠a bold para destacar este mensaje.",
                        "Idea: Crear una serie de 3 posts conectada visualmente (carrusel).",
                        "Para este formato impreso, recuerda dejar m√°rgenes de seguridad de 3mm.",
                        "Optimizado: 'Impacta visualmente con un dise√±o minimalista y llamada a la acci√≥n clara.'"
                    ];
                    resolve(responses[Math.floor(Math.random() * responses.length)]);
                }, 1000);
            });
        };

        // --- Icon Component ---
        const Icon = ({ name, size = 18, className = "" }) => {
            const svgContent = React.useMemo(() => {
                if (!window.lucide || !window.lucide.icons || !window.lucide.icons[name]) return null;
                try {
                    const element = window.lucide.createElement(window.lucide.icons[name]);
                    element.setAttribute('width', size);
                    element.setAttribute('height', size);
                    const existingClass = element.getAttribute('class') || '';
                    element.setAttribute('class', `${existingClass} ${className}`.trim());
                    return { __html: element.outerHTML };
                } catch (err) { return null; }
            }, [name, size, className]);

            if (!svgContent) return <span style={{width: size, height: size}} className={`inline-block bg-gray-200 rounded ${className}`} />;
            return <span dangerouslySetInnerHTML={svgContent} className="inline-flex items-center justify-center" />;
        };

        // --- Calendar Month ---
        const CalendarMonth = ({ year, month, events, onAddEvent }) => {
            const date = new Date(year, month, 1);
            const monthName = date.toLocaleString('es-ES', { month: 'long' });
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const startDay = date.getDay(); // 0 = Sunday

            const getEventStyle = (type) => {
                switch(type) {
                    case 'holiday': return 'bg-red-50 text-red-700 border border-red-200';
                    case 'campaign': return 'bg-green-50 text-green-700 border border-green-200';
                    case 'task-start': return 'bg-purple-50 text-purple-700 border border-purple-200';
                    case 'task-end': return 'bg-orange-50 text-orange-800 border border-orange-200 font-semibold';
                    default: return 'bg-blue-50 text-blue-700 border border-blue-200';
                }
            };

            const days = [];
            for (let i = 0; i < startDay; i++) days.push(<div key={`empty-${i}`} className="h-24 md:h-28 bg-gray-50/30"></div>);
            
            for (let i = 1; i <= daysInMonth; i++) {
                const dayKey = `${year}-${String(month + 1).padStart(2, '0')}-${String(i).padStart(2, '0')}`;
                const dayEvents = events[dayKey] || [];
                
                days.push(
                    <div key={i} onClick={() => onAddEvent(dayKey)} className="h-24 md:h-28 border border-gray-100 bg-white hover:bg-blue-50/30 transition-all p-1 cursor-pointer flex flex-col relative group calendar-day">
                        <span className="text-[10px] font-bold text-gray-400 mb-1">{i}</span>
                        <div className="flex flex-col gap-1 overflow-y-auto custom-scrollbar flex-1">
                            {dayEvents.map((ev, idx) => (
                                <div key={idx} className={`text-[8px] md:text-[9px] px-1 py-0.5 rounded-md truncate leading-tight ${getEventStyle(ev.type)}`}>
                                    {ev.text}
                                </div>
                            ))}
                        </div>
                    </div>
                );
            }

            return (
                <div className="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden flex flex-col min-w-[300px]">
                    <div className="bg-zignal-dark text-white p-2 md:p-3 text-center font-bold capitalize text-sm">{monthName} {year}</div>
                    <div className="grid grid-cols-7 text-center text-[9px] font-bold uppercase text-gray-400 py-2 border-b bg-gray-50">
                        <div>Do</div><div>Lu</div><div>Ma</div><div>Mi</div><div>Ju</div><div>Vi</div><div>Sa</div>
                    </div>
                    <div className="grid grid-cols-7 bg-gray-100 gap-px border-b border-l border-r border-gray-200 flex-1">
                        {days}
                    </div>
                </div>
            );
        };

        // --- Modals ---
        const ConfirmModal = ({ isOpen, onClose, onConfirm, title, message }) => {
            if (!isOpen) return null;
            return (
                <div className="fixed inset-0 z-[60] flex items-center justify-center bg-black/60 backdrop-blur-sm fade-in p-4">
                    <div className="bg-white rounded-2xl shadow-xl p-6 w-full max-w-sm border border-gray-100">
                        <div className="flex items-center gap-3 text-red-600 mb-4">
                            <Icon name="AlertTriangle" size={24} />
                            <h3 className="text-lg font-bold text-gray-900">{title}</h3>
                        </div>
                        <p className="text-sm text-gray-600 mb-6">{message}</p>
                        <div className="flex justify-end gap-3">
                            <button onClick={onClose} className="px-4 py-2 rounded-lg text-gray-700 bg-gray-100 font-medium text-sm">Cancelar</button>
                            <button onClick={onConfirm} className="px-4 py-2 rounded-lg bg-red-600 text-white font-medium shadow-md text-sm">Eliminar</button>
                        </div>
                    </div>
                </div>
            );
        };

        const TaskModal = ({ isOpen, onClose, onSave, task = null }) => {
            const [formData, setFormData] = useState({
                id: null, dateRequest: new Date().toISOString().split('T')[0], requester: 'Zignal', campaignName: '', 
                format: 'Post', location: 'Instagram', description: '', referenceLink: '', deadline: '', 
                includedInPlan: true, price: 0, status: 'Pending', priority: 'Medium'
            });
            const [errors, setErrors] = useState({});
            const [aiLoading, setAiLoading] = useState(false);

            useEffect(() => {
                if (task) setFormData(task);
                else setFormData({
                    id: null, dateRequest: new Date().toISOString().split('T')[0], requester: 'Zignal', campaignName: '', 
                    format: 'Post', location: 'Instagram', description: '', referenceLink: '', deadline: '', 
                    includedInPlan: true, price: 0, status: 'Pending', priority: 'Medium'
                });
                setErrors({});
            }, [task, isOpen]);

            const handleChange = (e) => {
                const { name, value, type, checked } = e.target;
                setFormData(prev => ({ ...prev, [name]: type === 'checkbox' ? checked : value }));
                if (errors[name]) setErrors(prev => ({ ...prev, [name]: null }));
            };

            const validate = () => {
                const newErrors = {};
                if (!formData.campaignName.trim()) newErrors.campaignName = "Requerido";
                if (!formData.deadline) newErrors.deadline = "Requerido";
                setErrors(newErrors);
                return Object.keys(newErrors).length === 0;
            };

            const handleAIImprove = async () => {
                if (!formData.description) return;
                setAiLoading(true);
                const improvedText = await callGemini(`Mejora: ${formData.description}`);
                setFormData(prev => ({ ...prev, description: prev.description + "\n\n‚ú® " + improvedText }));
                setAiLoading(false);
            };

            if (!isOpen) return null;

            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center bg-zignal-dark/80 backdrop-blur-md fade-in p-4 sm:p-6 overflow-y-auto">
                    <div className="bg-white rounded-2xl shadow-2xl w-full max-w-2xl border border-gray-200 flex flex-col max-h-[90vh]">
                        <div className="p-4 border-b border-gray-100 flex justify-between items-center bg-gray-50 rounded-t-2xl">
                            <h2 className="text-lg font-bold text-zignal-dark flex items-center gap-2">
                                <Icon name={task ? "FileText" : "PlusCircle"} className="text-zignal-blue" />
                                {task ? "Editar" : "Nueva Solicitud"}
                            </h2>
                            <button onClick={onClose} className="p-2 bg-white rounded-full text-gray-500 shadow-sm"><Icon name="X" size={20} /></button>
                        </div>

                        <div className="p-4 sm:p-6 overflow-y-auto grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6">
                            <div className="space-y-4">
                                <div>
                                    <label className="text-xs font-bold text-gray-500 uppercase">Campa√±a *</label>
                                    <input type="text" name="campaignName" value={formData.campaignName} onChange={handleChange} className={`w-full px-3 py-2 rounded-lg border ${errors.campaignName ? 'border-red-500' : 'border-gray-200'} mt-1`} placeholder="Nombre..." />
                                </div>
                                <div className="grid grid-cols-2 gap-3">
                                    <div>
                                        <label className="text-xs font-bold text-gray-500 uppercase">Solicitante</label>
                                        <select name="requester" value={formData.requester} onChange={handleChange} className="w-full px-2 py-2 rounded-lg border border-gray-200 mt-1 bg-white">
                                            <option>Zignal</option><option>Dept. Publicidad</option><option>Junta Directiva</option><option>Extra</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className="text-xs font-bold text-gray-500 uppercase">Formato</label>
                                        <select name="format" value={formData.format} onChange={handleChange} className="w-full px-2 py-2 rounded-lg border border-gray-200 mt-1 bg-white">
                                            <option>Post</option><option>Story</option><option>Reel</option><option>Impreso</option><option>Email</option>
                                        </select>
                                    </div>
                                </div>
                                <div className="grid grid-cols-2 gap-3">
                                    <div>
                                        <label className="text-xs font-bold text-gray-500 uppercase">Entrega *</label>
                                        <input type="date" name="deadline" value={formData.deadline} onChange={handleChange} className="w-full px-2 py-2 rounded-lg border border-gray-200 mt-1" />
                                    </div>
                                    <div>
                                        <label className="text-xs font-bold text-gray-500 uppercase">Solicitud</label>
                                        <input type="date" name="dateRequest" value={formData.dateRequest} onChange={handleChange} className="w-full px-2 py-2 rounded-lg border border-gray-200 mt-1" />
                                    </div>
                                </div>
                                <div>
                                    <label className="text-xs font-bold text-gray-500 uppercase">Link Referencia</label>
                                    <input type="url" name="referenceLink" value={formData.referenceLink} onChange={handleChange} className="w-full px-3 py-2 rounded-lg border border-gray-200 mt-1" placeholder="https://..." />
                                </div>
                            </div>
                            <div className="space-y-4">
                                <div className="grid grid-cols-2 gap-3">
                                    <div>
                                        <label className="text-xs font-bold text-gray-500 uppercase">Estatus</label>
                                        <select name="status" value={formData.status} onChange={handleChange} className="w-full px-2 py-2 rounded-lg border border-gray-200 mt-1 bg-white">
                                            <option>Pending</option><option>In Progress</option><option>In Review</option><option>Waiting Approval</option><option>On Hold</option><option>Approved</option><option>Finalized</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label className="text-xs font-bold text-gray-500 uppercase">Prioridad</label>
                                        <select name="priority" value={formData.priority} onChange={handleChange} className="w-full px-2 py-2 rounded-lg border border-gray-200 mt-1 bg-white">
                                            <option>Low</option><option>Medium</option><option>High</option>
                                        </select>
                                    </div>
                                </div>
                                <div>
                                    <div className="flex justify-between mb-1">
                                        <label className="text-xs font-bold text-gray-500 uppercase">Descripci√≥n</label>
                                        <button onClick={handleAIImprove} disabled={aiLoading} className="text-xs text-zignal-blue font-bold flex items-center gap-1"><Icon name="Sparkles" size={12}/> IA</button>
                                    </div>
                                    <textarea name="description" rows="4" value={formData.description} onChange={handleChange} className="w-full px-3 py-2 rounded-lg border border-gray-200 text-sm"></textarea>
                                </div>
                                <div className={`p-3 rounded-lg border ${!formData.includedInPlan ? 'bg-blue-50 border-blue-200' : 'bg-gray-50'}`}>
                                    <label className="flex items-center justify-between">
                                        <span className="text-sm font-medium">Incluido en Plan</span>
                                        <input type="checkbox" name="includedInPlan" checked={formData.includedInPlan} onChange={handleChange} className="w-5 h-5 accent-zignal-blue" />
                                    </label>
                                    {!formData.includedInPlan && (
                                        <div className="mt-2">
                                            <input type="number" name="price" value={formData.price} onChange={handleChange} className="w-full px-3 py-1.5 rounded border border-blue-300 bg-white" placeholder="Costo extra" />
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>
                        <div className="p-4 border-t border-gray-100 flex justify-end gap-3 bg-gray-50 rounded-b-2xl">
                            <button onClick={onClose} className="px-5 py-2.5 rounded-xl text-gray-600 font-medium">Cancelar</button>
                            <button onClick={() => { if(validate()) onSave(formData); }} className="px-5 py-2.5 rounded-xl bg-zignal-dark text-white font-medium shadow-lg flex items-center gap-2">
                                <Icon name="Save" size={18} /> Guardar
                            </button>
                        </div>
                    </div>
                </div>
            );
        };

        const StatCard = ({ title, value, icon, colorClass, subtext }) => (
            <div className="bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex items-center justify-between">
                <div>
                    <p className="text-gray-500 text-[10px] font-bold uppercase tracking-wider">{title}</p>
                    <h3 className="text-xl font-bold text-gray-800">{value}</h3>
                    {subtext && <p className="text-[10px] text-gray-400">{subtext}</p>}
                </div>
                <div className={`p-2 rounded-lg ${colorClass} bg-opacity-10 text-opacity-100`}>
                    <div className={colorClass.replace('bg-', 'text-')}><Icon name={icon} size={20} /></div>
                </div>
            </div>
        );

        // --- Main App ---
        const App = () => {
            const [tasks, setTasks] = useState(initialData);
            const [view, setView] = useState('active');
            const [isModalOpen, setIsModalOpen] = useState(false);
            const [currentTask, setCurrentTask] = useState(null);
            const [deleteModal, setDeleteModal] = useState({ isOpen: false, taskId: null });
            const [calendarEvents, setCalendarEvents] = useState(initialEvents);

            const filteredTasks = useMemo(() => {
                const history = ['Approved', 'Finalized'];
                return tasks.filter(t => view === 'active' ? !history.includes(t.status) : history.includes(t.status));
            }, [tasks, view]);

            const mergedEvents = useMemo(() => {
                const combined = { ...calendarEvents };
                // Asegurar copia profunda de arrays
                Object.keys(combined).forEach(key => combined[key] = [...combined[key]]);
                
                tasks.forEach(t => {
                    if (t.status === 'Finalized') return;
                    if (t.dateRequest) {
                        if (!combined[t.dateRequest]) combined[t.dateRequest] = [];
                        combined[t.dateRequest].push({ text: `üöÄ ${t.campaignName}`, type: 'task-start' });
                    }
                    if (t.deadline) {
                        if (!combined[t.deadline]) combined[t.deadline] = [];
                        combined[t.deadline].push({ text: `üèÅ ${t.campaignName}`, type: 'task-end' });
                    }
                });
                return combined;
            }, [tasks, calendarEvents]);

            const stats = useMemo(() => {
                const active = tasks.filter(t => !['Approved', 'Finalized'].includes(t.status)).length;
                const pending = tasks.filter(t => t.status === 'Pending').length;
                const high = tasks.filter(t => t.priority === 'High' && !['Approved', 'Finalized'].includes(t.status)).length;
                const extra = tasks.reduce((acc, c) => acc + (!c.includedInPlan ? parseFloat(c.price || 0) : 0), 0);
                return { active, pending, high, extra };
            }, [tasks]);

            return (
                <div className="min-h-screen">
                    {/* Header Mobile Friendly */}
                    <div className="bg-white border-b border-gray-200 sticky top-0 z-30 px-4 py-3 flex justify-between items-center shadow-sm">
                        <div className="flex items-center gap-2">
                            <div className="w-8 h-8 bg-zignal-dark rounded flex items-center justify-center text-white"><Icon name="Zap" size={18} /></div>
                            <h1 className="text-lg font-bold leading-none hidden sm:block">Zignal Agency</h1>
                        </div>
                        <div className="flex gap-3">
                            <div className="w-8 h-8 rounded-full bg-gradient-to-r from-zignal-blue to-zignal-cyan border-2 border-white shadow"></div>
                        </div>
                    </div>

                    <div className="max-w-7xl mx-auto p-4 space-y-6">
                        {/* Stats Mobile Grid */}
                        <div className="grid grid-cols-2 lg:grid-cols-4 gap-3">
                            <StatCard title="Activas" value={stats.active} icon="Zap" colorClass="bg-blue-500" />
                            <StatCard title="Pendientes" value={stats.pending} icon="Clock" colorClass="bg-amber-500" />
                            <StatCard title="Urgentes" value={stats.high} icon="Flag" colorClass="bg-red-500" />
                            <StatCard title="Extras" value={`$${stats.extra}`} icon="DollarSign" colorClass="bg-emerald-500" />
                        </div>

                        {/* Toolbar */}
                        <div className="flex flex-col sm:flex-row justify-between gap-3 bg-white p-3 rounded-xl border border-gray-200 shadow-sm">
                            <div className="flex bg-gray-100 p-1 rounded-lg self-start">
                                <button onClick={() => setView('active')} className={`px-3 py-1.5 rounded-md text-xs font-bold uppercase ${view === 'active' ? 'bg-white shadow-sm' : 'text-gray-500'}`}>Activas</button>
                                <button onClick={() => setView('history')} className={`px-3 py-1.5 rounded-md text-xs font-bold uppercase ${view === 'history' ? 'bg-white shadow-sm' : 'text-gray-500'}`}>Historial</button>
                            </div>
                            <button onClick={() => { setCurrentTask(null); setIsModalOpen(true); }} className="flex items-center justify-center gap-2 px-4 py-2 rounded-lg bg-zignal-dark text-white text-sm font-medium shadow-md active:scale-95 transition-transform">
                                <Icon name="Plus" size={16} /> Nueva Solicitud
                            </button>
                        </div>

                        {/* Table Scrollable Container */}
                        <div className="bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden">
                            <div className="overflow-x-auto">
                                <table className="w-full text-left whitespace-nowrap">
                                    <thead>
                                        <tr className="bg-gray-50 text-[10px] text-gray-500 font-bold uppercase border-b">
                                            <th className="px-4 py-3">Campa√±a</th>
                                            <th className="px-4 py-3">Formato</th>
                                            <th className="px-4 py-3">Entrega</th>
                                            <th className="px-4 py-3">Estatus</th>
                                            <th className="px-4 py-3 text-center">Prioridad</th>
                                            <th className="px-4 py-3 text-right">Acci√≥n</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-gray-50 text-sm">
                                        {filteredTasks.length === 0 ? (
                                            <tr><td colSpan="6" className="px-4 py-8 text-center text-gray-400">Sin tareas</td></tr>
                                        ) : filteredTasks.map(t => (
                                            <tr key={t.id} onClick={() => { setCurrentTask(t); setIsModalOpen(true); }} className="hover:bg-blue-50 active:bg-blue-100 transition-colors cursor-pointer">
                                                <td className="px-4 py-3">
                                                    <p className="font-bold text-gray-800">{t.campaignName}</p>
                                                    <p className="text-xs text-gray-500">{t.requester}</p>
                                                </td>
                                                <td className="px-4 py-3 text-gray-600">
                                                    <div className="flex items-center gap-2">
                                                        {t.format === 'Reel' ? <Icon name="Video" size={14} /> : <Icon name="Image" size={14} />}
                                                        <span>{t.location}</span>
                                                    </div>
                                                </td>
                                                <td className="px-4 py-3 font-medium">
                                                    {new Date(t.deadline).toLocaleDateString('es-ES', {day: '2-digit', month: 'long'})}
                                                </td>
                                                <td className="px-4 py-3">
                                                    <span className={`px-2 py-0.5 rounded text-[10px] font-bold uppercase border ${
                                                        t.status === 'Pending' ? 'bg-amber-50 text-amber-700 border-amber-200' : 
                                                        t.status === 'In Progress' ? 'bg-blue-50 text-blue-700 border-blue-200' :
                                                        t.status === 'Finalized' ? 'bg-gray-800 text-white border-gray-800' :
                                                        'bg-green-50 text-green-700 border-green-200'
                                                    }`}>{t.status}</span>
                                                </td>
                                                <td className="px-4 py-3 text-center">
                                                    <span className={`px-2 py-0.5 rounded text-[10px] font-bold border ${
                                                        t.priority === 'High' ? 'bg-red-50 text-red-700 border-red-200' : 'bg-green-50 text-green-700 border-green-200'
                                                    }`}>{t.priority}</span>
                                                </td>
                                                <td className="px-4 py-3 text-right">
                                                    <button onClick={(e) => { e.stopPropagation(); setDeleteModal({ isOpen: true, taskId: t.id }); }} className="p-2 bg-gray-100 rounded text-gray-500 hover:text-red-500">
                                                        <Icon name="Trash2" size={16} />
                                                    </button>
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        {/* Calendar Mobile Horizontal Scroll */}
                        <div>
                            <h2 className="text-md font-bold text-gray-800 mb-3 flex items-center gap-2"><Icon name="Calendar" size={18} /> Calendario 2026</h2>
                            <div className="flex gap-4 overflow-x-auto pb-4 snap-x">
                                <div className="snap-center"><CalendarMonth year={2026} month={1} events={mergedEvents} onAddEvent={(d) => { if(confirm('Agregar evento?')) setCalendarEvents(p => ({...p, [d]: [...(p[d]||[]), {text:'Nota', type:'admin'}]})) }} /></div>
                                <div className="snap-center"><CalendarMonth year={2026} month={2} events={mergedEvents} onAddEvent={()=>{}} /></div>
                                <div className="snap-center"><CalendarMonth year={2026} month={3} events={mergedEvents} onAddEvent={()=>{}} /></div>
                            </div>
                        </div>
                    </div>

                    <TaskModal isOpen={isModalOpen} onClose={() => setIsModalOpen(false)} onSave={(d) => {
                        setTasks(p => d.id ? p.map(t => t.id === d.id ? d : t) : [{...d, id: Date.now()}, ...p]);
                        setIsModalOpen(false);
                    }} task={currentTask} />
                    
                    <ConfirmModal isOpen={deleteModal.isOpen} onClose={() => setDeleteModal({isOpen:false})} onConfirm={() => {
                        setTasks(p => p.filter(t => t.id !== deleteModal.taskId));
                        setDeleteModal({isOpen:false});
                    }} title="Borrar?" message="No podr√°s recuperar esta tarea." />
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
